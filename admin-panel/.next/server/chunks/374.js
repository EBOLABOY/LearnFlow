exports.id=374,exports.ids=[374],exports.modules={1323:(e,t)=>{"use strict";Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,s){return s in t?t[s]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,s)):"function"==typeof t&&"default"===s?t:void 0}}})},7722:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.d(t,{Z:()=>c});var a=s(997),n=s(6689),i=s(1163),o=s(330),l=e([o]);function c({children:e,title:t="管理后台"}){let[s,r]=(0,n.useState)(!1),{user:l,logout:c}=(0,o.aC)(),u=(0,i.useRouter)(),m=[{name:"仪表板",href:"/admin/dashboard",icon:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"},{name:"用户管理",href:"/admin/users",icon:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"},{name:"邀请码管理",href:"/admin/invitations",icon:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"}],x=e=>u.pathname===e;return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsxs)("div",{className:`fixed inset-0 z-40 lg:hidden ${s?"":"hidden"}`,children:[a.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75",onClick:()=>r(!1)}),(0,a.jsxs)("div",{className:"relative flex w-full max-w-xs flex-1 flex-col bg-white",children:[a.jsx("div",{className:"absolute top-0 right-0 -mr-12 pt-2",children:a.jsx("button",{type:"button",className:"ml-1 flex h-10 w-10 items-center justify-center rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",onClick:()=>r(!1),children:a.jsx("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})}),a.jsx(d,{navigation:m,isActive:x})]})]}),a.jsx("div",{className:"hidden lg:fixed lg:inset-y-0 lg:flex lg:w-64 lg:flex-col",children:a.jsx("div",{className:"flex min-h-0 flex-1 flex-col bg-white border-r border-gray-200",children:a.jsx(d,{navigation:m,isActive:x})})}),(0,a.jsxs)("div",{className:"flex flex-1 flex-col lg:pl-64",children:[a.jsx("div",{className:"sticky top-0 z-10 bg-white shadow-sm border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex h-16 items-center gap-x-4 px-4 sm:gap-x-6 sm:px-6 lg:px-8",children:[a.jsx("button",{type:"button",className:"-m-2.5 p-2.5 text-gray-700 lg:hidden",onClick:()=>r(!0),children:a.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),(0,a.jsxs)("div",{className:"flex flex-1 gap-x-4 self-stretch lg:gap-x-6",children:[a.jsx("div",{className:"flex flex-1 items-center",children:a.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:t})}),a.jsx("div",{className:"flex items-center gap-x-4 lg:gap-x-6",children:a.jsx("div",{className:"relative",children:(0,a.jsxs)("div",{className:"flex items-center gap-x-3",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"h-8 w-8 rounded-full bg-primary-600 flex items-center justify-center",children:a.jsx("span",{className:"text-sm font-medium text-white",children:l?.email?.charAt(0).toUpperCase()})})}),(0,a.jsxs)("div",{className:"hidden min-w-0 flex-1 lg:block",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:l?.email}),a.jsx("p",{className:"text-xs text-gray-500",children:"管理员"})]}),a.jsx("button",{onClick:c,className:"text-sm text-gray-500 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 rounded-md px-2 py-1",children:"退出"})]})})})]})]})}),a.jsx("main",{className:"flex-1 pb-8",children:a.jsx("div",{className:"px-4 sm:px-6 lg:px-8 py-8",children:e})})]})]})}function d({navigation:e,isActive:t}){return(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"flex h-16 shrink-0 items-center border-b border-gray-200 px-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:"h-8 w-8 bg-gradient-to-br from-primary-500 to-primary-700 rounded-lg flex items-center justify-center",children:a.jsx("span",{className:"text-sm font-bold text-white",children:"深"})}),a.jsx("span",{className:"ml-2 text-lg font-semibold text-gray-900",children:"学助手"})]})}),a.jsx("nav",{className:"flex-1 space-y-1 px-2 py-4",children:e.map(e=>(0,a.jsxs)("a",{href:e.href,className:`
              group flex items-center px-2 py-2 text-sm font-medium rounded-md transition-colors duration-200
              ${t(e.href)?"bg-primary-100 text-primary-700":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}
            `,children:[a.jsx("svg",{className:`mr-3 h-5 w-5 flex-shrink-0 ${t(e.href)?"text-primary-500":"text-gray-400 group-hover:text-gray-500"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:e.icon})}),e.name]},e.name))})]})}o=(l.then?(await l)():l)[0],r()}catch(e){r(e)}})},7751:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.d(t,{Sb:()=>c,hi:()=>l});var a=s(9648),n=s(9915),i=s(6201),o=e([a,n,i]);[a,n,i]=o.then?(await o)():o;let l=a.default.create({baseURL:"https://learn-flow-ashy.vercel.app/api",timeout:1e4,headers:{"Content-Type":"application/json"}});l.interceptors.request.use(e=>{let t=n.default.get("admin_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,e=>(e.response?.status===401?n.default.remove("admin_token"):e.response?e.response.status>=500&&i.default.error("服务器暂时无法响应，请稍后重试"):i.default.error("网络连接失败，请检查网络设置"),Promise.reject(e)));let c={login:(e,t)=>l.post("/admin/login",{email:e,password:t}),getProfile:()=>l.get("/admin/profile"),getUsers:(e={})=>l.get("/admin/users",{params:e}),updateUser:(e,t)=>l.put(`/admin/users/${e}`,t),deleteUser:e=>l.delete(`/admin/users/${e}`),getInvitations:(e={})=>l.get("/admin/invitations",{params:e}),createInvitations:e=>l.post("/admin/invitations",e),revokeInvitation:e=>l.delete(`/admin/invitations/${e}`),getStats:()=>l.get("/admin/stats"),getLogs:(e={})=>l.get("/admin/logs",{params:e})};r()}catch(e){r(e)}})},330:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.d(t,{Ho:()=>d,QO:()=>m,aC:()=>u});var a=s(997),n=s(6689),i=s(1163),o=s(9915);s(9344);var l=s(7751),c=e([o,l]);[o,l]=c.then?(await c)():c;let x=(0,n.createContext)({});function d({children:e}){let[t,s]=(0,n.useState)(null),[r,c]=(0,n.useState)(!0),d=(0,i.useRouter)(),u=async()=>{try{if(!o.default.get("admin_token")){c(!1);return}let e=await l.hi.get("/admin/profile");e.data.success?s(e.data.user):o.default.remove("admin_token")}catch(e){console.error("Auth check failed:",e),o.default.remove("admin_token")}finally{c(!1)}},m=async(e,t)=>{try{let r=await l.hi.post("/admin/login",{email:e,password:t});if(!r.data.success)return{success:!1,message:r.data.message};{let{token:e,user:t}=r.data;return o.default.set("admin_token",e,{expires:7,secure:!0,sameSite:"strict"}),s(t),{success:!0}}}catch(e){return{success:!1,message:e.response?.data?.message||"登录失败，请稍后重试"}}},h={user:t,loading:r,login:m,logout:()=>{o.default.remove("admin_token"),s(null),d.push("/admin/login")},checkAuth:u,isAuthenticated:!!t&&"admin"===t.role};return a.jsx(x.Provider,{value:h,children:e})}function u(){let e=(0,n.useContext)(x);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}function m(e){return function(t){let{user:s,loading:r}=u();return((0,i.useRouter)(),r)?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):s&&"admin"===s.role?a.jsx(e,{...t}):null}}r()}catch(e){r(e)}})},3414:(e,t,s)=>{"use strict";s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{default:()=>l});var a=s(997);s(6764);var n=s(6201),i=s(330),o=e([n,i]);function l({Component:e,pageProps:t}){return(0,a.jsxs)(i.Ho,{children:[a.jsx(e,{...t}),a.jsx(n.Toaster,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff",borderRadius:"8px",padding:"12px 16px",fontSize:"14px"},success:{iconTheme:{primary:"#10b981",secondary:"#fff"}},error:{iconTheme:{primary:"#ef4444",secondary:"#fff"}}}})]})}[n,i]=o.then?(await o)():o,r()}catch(e){r(e)}})},5949:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var r=s(997),a=s(6859);function n(){return(0,r.jsxs)(a.Html,{lang:"zh-CN",children:[(0,r.jsxs)(a.Head,{children:[r.jsx("meta",{charSet:"utf-8"}),r.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),r.jsx("meta",{name:"theme-color",content:"#667eea"}),r.jsx("meta",{name:"description",content:"深学助手管理后台 - 用户和邀请码管理系统"}),r.jsx("link",{rel:"icon",href:"/favicon.ico"}),r.jsx("link",{rel:"apple-touch-icon",sizes:"180x180",href:"/apple-touch-icon.png"}),r.jsx("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),r.jsx("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:"true"}),r.jsx("meta",{httpEquiv:"X-Content-Type-Options",content:"nosniff"}),r.jsx("meta",{httpEquiv:"X-Frame-Options",content:"DENY"}),r.jsx("meta",{httpEquiv:"X-XSS-Protection",content:"1; mode=block"}),r.jsx("meta",{name:"referrer",content:"strict-origin-when-cross-origin"})]}),(0,r.jsxs)("body",{className:"bg-gray-50",children:[r.jsx(a.Main,{}),r.jsx(a.NextScript,{})]})]})}},4153:(e,t,s)=>{"use strict";s.d(t,{Cl:()=>n,Ds:()=>o,SY:()=>a,li:()=>i,p6:()=>r,uf:()=>c,vQ:()=>l});let r=(e,t="YYYY-MM-DD HH:mm:ss")=>{if(!e)return"-";let s=new Date(e);if(isNaN(s.getTime()))return"-";let r=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0"),n=String(s.getDate()).padStart(2,"0"),i=String(s.getHours()).padStart(2,"0"),o=String(s.getMinutes()).padStart(2,"0"),l=String(s.getSeconds()).padStart(2,"0");return t.replace("YYYY",r).replace("MM",a).replace("DD",n).replace("HH",i).replace("mm",o).replace("ss",l)},a=e=>{if(!e)return"-";let t=Math.floor((new Date-new Date(e))/1e3),s=Math.floor(t/60),a=Math.floor(s/60),n=Math.floor(a/24);return t<60?"刚刚":s<60?`${s}分钟前`:a<24?`${a}小时前`:n<7?`${n}天前`:r(e,"YYYY-MM-DD")},n=e=>({active:"status-badge status-active",inactive:"status-badge status-inactive",used:"status-badge status-used",expired:"status-badge status-expired",disabled:"status-badge status-inactive"})[e]||"status-badge status-inactive",i=e=>({active:"活跃",inactive:"未激活",used:"已使用",expired:"已过期",disabled:"已禁用",revoked:"已撤销"})[e]||e,o=(e,t)=>{let s;return function(...r){clearTimeout(s),s=setTimeout(()=>{clearTimeout(s),e(...r)},t)}},l=async e=>{try{return await navigator.clipboard.writeText(e),!0}catch(s){let t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.focus(),t.select();try{return document.execCommand("copy"),!0}catch(e){return!1}finally{document.body.removeChild(t)}}},c=e=>e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},6764:()=>{},5244:(e,t)=>{"use strict";var s;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return s}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(s||(s={}))}};